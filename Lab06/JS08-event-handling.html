<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS08: Event Handling - Lab06 JavaScript Fundamentals</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #f7df1e;
            --secondary: #323330;
            --accent: #f0db4f;
            --text-dark: #2d2d2d;
            --text-light: #666;
            --bg-light: #fafafa;
            --border: #e0e0e0;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --info: #2196f3;
            --purple: #9c27b0;
            --teal: #009688;
            --pink: #e91e63;
            --indigo: #3f51b5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f7f9fc 0%, #f1f5f9 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .lesson-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            border-radius: 15px;
            color: white;
        }

        .lesson-header h1 {
            font-size: clamp(2rem, 4vw, 3rem);
            margin-bottom: 10px;
        }

        .lesson-header .lesson-number {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: inline-block;
        }

        .section {
            margin: 40px 0;
            padding: 30px;
            background: var(--bg-light);
            border-radius: 15px;
            border-left: 5px solid var(--primary);
        }

        .section h2 {
            color: var(--text-dark);
            margin-bottom: 20px;
            font-size: clamp(1.3rem, 3vw, 1.8rem);
        }

        .section h3 {
            color: var(--secondary);
            margin: 25px 0 15px 0;
            font-size: 1.2rem;
        }

        .code-demo {
            background: var(--secondary);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            position: relative;
            overflow-x: auto;
        }

        .code-demo::before {
            content: "JavaScript";
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 0.7rem;
            color: var(--primary);
            opacity: 0.7;
        }

        .code-demo pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
        }

        .code-comment {
            color: #68d391;
        }

        .code-string {
            color: #faf089;
        }

        .code-keyword {
            color: #63b3ed;
        }

        .code-number {
            color: #f6ad55;
        }

        .interactive-demo {
            background: white;
            border: 2px solid var(--info);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .demo-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            margin: 10px 0;
            transition: border-color 0.3s ease;
        }

        .demo-input:focus {
            border-color: var(--info);
            outline: none;
        }

        .demo-button {
            background: var(--primary);
            color: var(--secondary);
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .demo-button:hover {
            background: var(--accent);
            transform: translateY(-2px);
        }

        .demo-button:active {
            transform: translateY(0);
        }

        .demo-button.purple {
            background: var(--purple);
            color: white;
        }

        .demo-button.teal {
            background: var(--teal);
            color: white;
        }

        .demo-button.pink {
            background: var(--pink);
            color: white;
        }

        .demo-button.success {
            background: var(--success);
            color: white;
        }

        .demo-button.danger {
            background: var(--danger);
            color: white;
        }

        .demo-button.indigo {
            background: var(--indigo);
            color: white;
        }

        .demo-output {
            background: var(--secondary);
            color: var(--primary);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            min-height: 50px;
            border: 2px solid var(--primary);
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .event-showcase {
            background: linear-gradient(135deg, #e8f5e8, #f1f8e9);
            border: 2px solid var(--success);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .event-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .event-item {
            background: white;
            border: 2px solid var(--success);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .event-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .event-item h5 {
            color: var(--success);
            margin-bottom: 10px;
        }

        .interactive-playground {
            background: linear-gradient(135deg, #fff3e0, #fce4ec);
            border: 2px solid var(--pink);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .playground-area {
            background: white;
            border: 2px dashed var(--info);
            border-radius: 10px;
            padding: 30px;
            margin: 15px 0;
            min-height: 200px;
            text-align: center;
            position: relative;
        }

        .draggable-item {
            background: var(--info);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            margin: 10px;
            display: inline-block;
            cursor: move;
            user-select: none;
            transition: all 0.3s ease;
        }

        .draggable-item:hover {
            transform: scale(1.05);
        }

        .draggable-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .drop-zone {
            background: var(--bg-light);
            border: 3px dashed var(--border);
            border-radius: 10px;
            padding: 30px;
            margin: 15px 0;
            text-align: center;
            min-height: 100px;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            border-color: var(--success);
            background: rgba(76, 175, 80, 0.1);
        }

        .mouse-tracker {
            background: linear-gradient(135deg, #e3f2fd, #f0f8ff);
            border: 2px solid var(--info);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .tracker-display {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--info);
            font-family: 'Courier New', monospace;
        }

        .form-demo {
            background: linear-gradient(135deg, #f3e5f5, #fce4ec);
            border: 2px solid var(--purple);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .form-group {
            margin: 15px 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid var(--border);
        }

        .nav-btn {
            display: inline-block;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn.prev {
            background: #6c757d;
            color: white;
        }

        .nav-btn.next {
            background: var(--primary);
            color: var(--secondary);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-center {
            text-align: center;
        }

        .nav-center a {
            color: var(--info);
            text-decoration: none;
            font-weight: 500;
        }

        .clicked {
            animation: clickEffect 0.3s ease;
        }

        @keyframes clickEffect {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .highlight-event {
            background: var(--warning) !important;
            color: white !important;
            animation: pulse 1s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .navigation {
                flex-direction: column;
                gap: 15px;
            }
            
            .demo-grid,
            .event-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="lesson-header">
            <div class="lesson-number">Lesson JS08</div>
            <h1>👂 Event Handling</h1>
            <p>Learn to respond to user interactions and create dynamic web experiences</p>
        </div>

        <!-- Event Basics -->
        <section class="section">
            <h2>🎯 What are Events?</h2>
            
            <p><strong>Events</strong> are actions that happen in the browser - user clicks, keyboard presses, page loads, etc. JavaScript can "listen" for these events và respond accordingly.</p>

            <div class="event-showcase">
                <h3>🎪 Common Event Types</h3>
                <div class="event-list">
                    <div class="event-item">
                        <h5>🖱️ Mouse Events</h5>
                        <p>click, dblclick, mousedown, mouseup, mouseover, mouseout</p>
                    </div>
                    <div class="event-item">
                        <h5>⌨️ Keyboard Events</h5>
                        <p>keydown, keyup, keypress</p>
                    </div>
                    <div class="event-item">
                        <h5>📝 Form Events</h5>
                        <p>submit, change, input, focus, blur</p>
                    </div>
                    <div class="event-item">
                        <h5>🪟 Window Events</h5>
                        <p>load, resize, scroll, beforeunload</p>
                    </div>
                    <div class="event-item">
                        <h5>👆 Touch Events</h5>
                        <p>touchstart, touchmove, touchend</p>
                    </div>
                    <div class="event-item">
                        <h5>🎨 Animation Events</h5>
                        <p>animationstart, animationend, transitionend</p>
                    </div>
                </div>
            </div>

            <h3>Adding Event Listeners</h3>
            <div class="code-demo">
                <pre><code><span class="code-comment">// Method 1: addEventListener (recommended)</span>
<span class="code-keyword">let</span> button = <span class="code-keyword">document</span>.<span class="code-keyword">getElementById</span>(<span class="code-string">"myButton"</span>);

button.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>() {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Button clicked!"</span>);
});

<span class="code-comment">// Arrow function syntax</span>
button.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, () => {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Button clicked with arrow function!"</span>);
});

<span class="code-comment">// Named function</span>
<span class="code-keyword">function</span> <span class="code-keyword">handleClick</span>() {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Button clicked with named function!"</span>);
}
button.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handleClick);

<span class="code-comment">// Method 2: Inline event handlers (not recommended)</span>
<span class="code-comment">// &lt;button onclick="handleClick()"&gt;Click me&lt;/button&gt;</span>

<span class="code-comment">// Method 3: Event properties</span>
button.<span class="code-keyword">onclick</span> = <span class="code-keyword">function</span>() {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Button clicked via property!"</span>);
};</code></pre>
            </div>
        </section>

        <!-- Event Object -->
        <section class="section">
            <h2>📋 The Event Object</h2>
            
            <p>Event handlers receive an <strong>event object</strong> that contains useful information about the event:</p>

            <div class="code-demo">
                <pre><code><span class="code-comment">// Event object contains useful information</span>
button.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Event type:"</span>, event.<span class="code-keyword">type</span>); <span class="code-comment">// "click"</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Target element:"</span>, event.<span class="code-keyword">target</span>); <span class="code-comment">// The clicked element</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Mouse X position:"</span>, event.<span class="code-keyword">clientX</span>);
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Mouse Y position:"</span>, event.<span class="code-keyword">clientY</span>);
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Timestamp:"</span>, event.<span class="code-keyword">timeStamp</span>);
});

<span class="code-comment">// Keyboard events</span>
<span class="code-keyword">document</span>.<span class="code-keyword">addEventListener</span>(<span class="code-string">"keydown"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Key pressed:"</span>, event.<span class="code-keyword">key</span>); <span class="code-comment">// The actual key</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Key code:"</span>, event.<span class="code-keyword">keyCode</span>); <span class="code-comment">// Numeric code</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Ctrl key:"</span>, event.<span class="code-keyword">ctrlKey</span>); <span class="code-comment">// true/false</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Shift key:"</span>, event.<span class="code-keyword">shiftKey</span>); <span class="code-comment">// true/false</span>
});

<span class="code-comment">// Form events</span>
<span class="code-keyword">let</span> input = <span class="code-keyword">document</span>.<span class="code-keyword">querySelector</span>(<span class="code-string">"input"</span>);
input.<span class="code-keyword">addEventListener</span>(<span class="code-string">"input"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Input value:"</span>, event.<span class="code-keyword">target</span>.<span class="code-keyword">value</span>);
});</code></pre>
            </div>

            <h3>Preventing Default Behavior</h3>
            <div class="code-demo">
                <pre><code><span class="code-comment">// Prevent form submission</span>
<span class="code-keyword">let</span> form = <span class="code-keyword">document</span>.<span class="code-keyword">querySelector</span>(<span class="code-string">"form"</span>);
form.<span class="code-keyword">addEventListener</span>(<span class="code-string">"submit"</span>, <span class="code-keyword">function</span>(event) {
    event.<span class="code-keyword">preventDefault</span>(); <span class="code-comment">// Stop form from submitting</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Form submission prevented"</span>);
});

<span class="code-comment">// Prevent link navigation</span>
<span class="code-keyword">let</span> link = <span class="code-keyword">document</span>.<span class="code-keyword">querySelector</span>(<span class="code-string">"a"</span>);
link.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>(event) {
    event.<span class="code-keyword">preventDefault</span>();
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Link click prevented"</span>);
});

<span class="code-comment">// Stop event propagation</span>
<span class="code-keyword">let</span> childElement = <span class="code-keyword">document</span>.<span class="code-keyword">querySelector</span>(<span class="code-string">".child"</span>);
childElement.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>(event) {
    event.<span class="code-keyword">stopPropagation</span>(); <span class="code-comment">// Stop event from bubbling up</span>
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Child clicked, propagation stopped"</span>);
});</code></pre>
            </div>
        </section>

        <!-- Event Delegation -->
        <section class="section">
            <h2>🎭 Event Delegation</h2>
            
            <p><strong>Event delegation</strong> uses event bubbling to handle events efficiently by attaching a single listener to a parent element:</p>

            <div class="code-demo">
                <pre><code><span class="code-comment">// Instead of adding listeners to each button individually</span>
<span class="code-keyword">let</span> buttons = <span class="code-keyword">document</span>.<span class="code-keyword">querySelectorAll</span>(<span class="code-string">".button"</span>);
buttons.<span class="code-keyword">forEach</span>(<span class="code-keyword">button</span> => {
    button.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handleButtonClick);
});

<span class="code-comment">// Use event delegation on the parent container</span>
<span class="code-keyword">let</span> container = <span class="code-keyword">document</span>.<span class="code-keyword">getElementById</span>(<span class="code-string">"buttonContainer"</span>);
container.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-comment">// Check if clicked element is a button</span>
    <span class="code-keyword">if</span> (event.<span class="code-keyword">target</span>.<span class="code-keyword">classList</span>.<span class="code-keyword">contains</span>(<span class="code-string">"button"</span>)) {
        <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Button clicked:"</span>, event.<span class="code-keyword">target</span>.<span class="code-keyword">textContent</span>);
    }
});

<span class="code-comment">// More specific delegation with matches()</span>
container.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-keyword">if</span> (event.<span class="code-keyword">target</span>.<span class="code-keyword">matches</span>(<span class="code-string">".delete-btn"</span>)) {
        <span class="code-comment">// Handle delete button click</span>
        event.<span class="code-keyword">target</span>.<span class="code-keyword">closest</span>(<span class="code-string">"li"</span>).<span class="code-keyword">remove</span>();
    } <span class="code-keyword">else if</span> (event.<span class="code-keyword">target</span>.<span class="code-keyword">matches</span>(<span class="code-string">".edit-btn"</span>)) {
        <span class="code-comment">// Handle edit button click</span>
        <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Edit button clicked"</span>);
    }
});</code></pre>
            </div>
        </section>

        <!-- Interactive Demos -->
        <section class="section">
            <h2>🎮 Interactive Event Lab</h2>
            
            <div class="demo-grid">
                <div class="interactive-demo">
                    <h4>🖱️ Mouse Event Tracker</h4>
                    <p>Track mouse movements và clicks:</p>
                    
                    <div class="mouse-tracker">
                        <div class="tracker-display" id="mouseTracker">
                            Move your mouse over this area and click!
                        </div>
                        
                        <div>
                            <button class="demo-button" onclick="clearMouseLog()">Clear Log</button>
                            <button class="demo-button purple" onclick="toggleMouseTracking()">Toggle Tracking</button>
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h4>⌨️ Keyboard Event Detector</h4>
                    <p>Press keys to see keyboard events:</p>
                    
                    <input type="text" id="keyboardInput" class="demo-input" placeholder="Type here to see key events...">
                    
                    <div id="keyboardOutput" class="demo-output">
                        Keyboard events will appear here...
                    </div>
                    
                    <div>
                        <button class="demo-button" onclick="clearKeyboardLog()">Clear Log</button>
                        <button class="demo-button teal" onclick="showSpecialKeys()">Show Special Keys</button>
                    </div>
                </div>
            </div>

            <div class="interactive-playground">
                <h4>🎪 Drag and Drop Playground</h4>
                <p>Try dragging items between zones:</p>
                
                <div class="playground-area">
                    <div class="draggable-item" draggable="true" data-item="1">📦 Item 1</div>
                    <div class="draggable-item" draggable="true" data-item="2">📦 Item 2</div>
                    <div class="draggable-item" draggable="true" data-item="3">📦 Item 3</div>
                </div>
                
                <div class="drop-zone" id="dropZone1">
                    Drop Zone 1 - Drop items here!
                </div>
                
                <div class="drop-zone" id="dropZone2">
                    Drop Zone 2 - Alternative drop area!
                </div>
                
                <div id="dragDropOutput" class="demo-output">
                    Drag and drop events will be logged here...
                </div>
            </div>

            <div class="form-demo">
                <h4>📝 Form Event Handler</h4>
                <p>Interactive form with real-time validation:</p>
                
                <form id="demoForm">
                    <div class="form-group">
                        <label for="nameInput">Name:</label>
                        <input type="text" id="nameInput" class="demo-input" placeholder="Enter your name" required>
                        <small id="nameError" style="color: red; display: none;">Name is required!</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="emailInput">Email:</label>
                        <input type="email" id="emailInput" class="demo-input" placeholder="Enter your email" required>
                        <small id="emailError" style="color: red; display: none;">Please enter a valid email!</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="ageInput">Age:</label>
                        <input type="number" id="ageInput" class="demo-input" placeholder="Enter your age" min="1" max="120">
                        <small id="ageError" style="color: red; display: none;">Age must be between 1 and 120!</small>
                    </div>
                    
                    <div>
                        <button type="submit" class="demo-button success">Submit Form</button>
                        <button type="reset" class="demo-button danger">Reset Form</button>
                    </div>
                </form>
                
                <div id="formOutput" class="demo-output">
                    Form events and validation results will appear here...
                </div>
            </div>
        </section>

        <!-- Advanced Event Concepts -->
        <section class="section">
            <h2>🚀 Advanced Event Concepts</h2>
            
            <h3>Event Phases</h3>
            <div class="code-demo">
                <pre><code><span class="code-comment">// Event flows through three phases:</span>
<span class="code-comment">// 1. Capturing phase (top-down)</span>
<span class="code-comment">// 2. Target phase</span>
<span class="code-comment">// 3. Bubbling phase (bottom-up)</span>

<span class="code-comment">// Listen during capturing phase</span>
element.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handler, <span class="code-keyword">true</span>); <span class="code-comment">// true = capture</span>

<span class="code-comment">// Listen during bubbling phase (default)</span>
element.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handler, <span class="code-keyword">false</span>); <span class="code-comment">// false = bubble</span>

<span class="code-comment">// Modern syntax with options</span>
element.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handler, {
    capture: <span class="code-keyword">false</span>, <span class="code-comment">// Bubbling phase</span>
    once: <span class="code-keyword">true</span>, <span class="code-comment">// Execute only once</span>
    passive: <span class="code-keyword">true</span> <span class="code-comment">// Never calls preventDefault()</span>
});</code></pre>
            </div>

            <h3>Custom Events</h3>
            <div class="code-demo">
                <pre><code><span class="code-comment">// Create custom events</span>
<span class="code-keyword">let</span> customEvent = <span class="code-keyword">new CustomEvent</span>(<span class="code-string">"myCustomEvent"</span>, {
    detail: {
        message: <span class="code-string">"Hello from custom event!"</span>,
        timestamp: <span class="code-keyword">Date</span>.<span class="code-keyword">now</span>()
    },
    bubbles: <span class="code-keyword">true</span>,
    cancelable: <span class="code-keyword">true</span>
});

<span class="code-comment">// Listen for custom event</span>
<span class="code-keyword">document</span>.<span class="code-keyword">addEventListener</span>(<span class="code-string">"myCustomEvent"</span>, <span class="code-keyword">function</span>(event) {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Custom event received:"</span>, event.<span class="code-keyword">detail</span>);
});

<span class="code-comment">// Dispatch (trigger) the custom event</span>
<span class="code-keyword">document</span>.<span class="code-keyword">dispatchEvent</span>(customEvent);

<span class="code-comment">// Simple custom event</span>
<span class="code-keyword">let</span> simpleEvent = <span class="code-keyword">new Event</span>(<span class="code-string">"dataLoaded"</span>);
element.<span class="code-keyword">dispatchEvent</span>(simpleEvent);</code></pre>
            </div>

            <h3>Removing Event Listeners</h3>
            <div class="code-demo">
                <pre><code><span class="code-comment">// To remove an event listener, you need the same function reference</span>
<span class="code-keyword">function</span> <span class="code-keyword">myHandler</span>(event) {
    <span class="code-keyword">console</span>.<span class="code-keyword">log</span>(<span class="code-string">"Event handled"</span>);
}

<span class="code-comment">// Add listener</span>
element.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, myHandler);

<span class="code-comment">// Remove listener</span>
element.<span class="code-keyword">removeEventListener</span>(<span class="code-string">"click"</span>, myHandler);

<span class="code-comment">// AbortController for easier cleanup (modern approach)</span>
<span class="code-keyword">let</span> controller = <span class="code-keyword">new AbortController</span>();

element.<span class="code-keyword">addEventListener</span>(<span class="code-string">"click"</span>, handler, {
    signal: controller.<span class="code-keyword">signal</span>
});

<span class="code-comment">// Remove all listeners added with this controller</span>
controller.<span class="code-keyword">abort</span>();</code></pre>
            </div>
        </section>

        <!-- Navigation -->
        <div class="navigation">
            <a href="JS07-dom-basics.html" class="nav-btn prev">← JS07: DOM Basics</a>
            
            <div class="nav-center">
                <a href="index.html">📚 Course Overview</a>
            </div>
            
            <a href="JS09-dom-projects.html" class="nav-btn next">JS09: DOM Projects →</a>
        </div>
    </div>

    <script>
        // Mouse event tracking
        let mouseTrackingEnabled = true;
        let mouseEvents = [];

        function setupMouseTracking() {
            const tracker = document.getElementById('mouseTracker');
            
            tracker.addEventListener('mousemove', function(event) {
                if (!mouseTrackingEnabled) return;
                
                const rect = tracker.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                const logEntry = `Mouse: (${x.toFixed(0)}, ${y.toFixed(0)})`;
                mouseEvents.push(logEntry);
                
                if (mouseEvents.length > 5) {
                    mouseEvents.shift();
                }
                
                tracker.textContent = mouseEvents.join('\n');
            });
            
            tracker.addEventListener('click', function(event) {
                if (!mouseTrackingEnabled) return;
                
                const logEntry = `CLICK at (${event.offsetX}, ${event.offsetY}) - ${new Date().toLocaleTimeString()}`;
                mouseEvents.push(logEntry);
                
                if (mouseEvents.length > 5) {
                    mouseEvents.shift();
                }
                
                tracker.textContent = mouseEvents.join('\n');
                tracker.classList.add('clicked');
                setTimeout(() => tracker.classList.remove('clicked'), 300);
            });
        }

        function clearMouseLog() {
            mouseEvents = [];
            document.getElementById('mouseTracker').textContent = 'Mouse log cleared. Move your mouse over this area and click!';
        }

        function toggleMouseTracking() {
            mouseTrackingEnabled = !mouseTrackingEnabled;
            const tracker = document.getElementById('mouseTracker');
            
            if (mouseTrackingEnabled) {
                tracker.textContent = 'Mouse tracking enabled. Move your mouse!';
            } else {
                tracker.textContent = 'Mouse tracking disabled.';
            }
        }

        // Keyboard event handling
        function setupKeyboardEvents() {
            const input = document.getElementById('keyboardInput');
            const output = document.getElementById('keyboardOutput');
            let keyEvents = [];
            
            input.addEventListener('keydown', function(event) {
                const logEntry = `KeyDown: "${event.key}" (Code: ${event.keyCode})${event.ctrlKey ? ' + Ctrl' : ''}${event.shiftKey ? ' + Shift' : ''}${event.altKey ? ' + Alt' : ''}`;
                keyEvents.push(logEntry);
                
                if (keyEvents.length > 8) {
                    keyEvents.shift();
                }
                
                output.textContent = keyEvents.join('\n');
                
                // Special key combinations
                if (event.ctrlKey && event.key === 'Enter') {
                    keyEvents.push('Special: Ctrl + Enter detected!');
                    output.textContent = keyEvents.join('\n');
                }
            });
            
            input.addEventListener('input', function(event) {
                const logEntry = `Input: "${event.target.value}" (Length: ${event.target.value.length})`;
                keyEvents.push(logEntry);
                
                if (keyEvents.length > 8) {
                    keyEvents.shift();
                }
                
                output.textContent = keyEvents.join('\n');
            });
        }

        function clearKeyboardLog() {
            document.getElementById('keyboardOutput').textContent = 'Keyboard log cleared. Type in the input field above!';
        }

        function showSpecialKeys() {
            const output = document.getElementById('keyboardOutput');
            output.textContent = `Special Key Combinations to Try:
- Ctrl + Enter
- Shift + any letter
- Alt + any key
- Arrow keys
- Function keys (F1, F2, etc.)
- Escape key
- Tab key

Type in the input field above to see these events!`;
        }

        // Drag and drop functionality
        function setupDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable-item');
            const dropZones = document.querySelectorAll('.drop-zone');
            const output = document.getElementById('dragDropOutput');
            let dragEvents = [];
            
            function logEvent(message) {
                dragEvents.push(`${new Date().toLocaleTimeString()}: ${message}`);
                if (dragEvents.length > 8) {
                    dragEvents.shift();
                }
                output.textContent = dragEvents.join('\n');
            }
            
            draggables.forEach(item => {
                item.addEventListener('dragstart', function(event) {
                    event.dataTransfer.setData('text/plain', event.target.dataset.item);
                    event.target.classList.add('dragging');
                    logEvent(`Started dragging ${event.target.textContent}`);
                });
                
                item.addEventListener('dragend', function(event) {
                    event.target.classList.remove('dragging');
                    logEvent(`Finished dragging ${event.target.textContent}`);
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', function(event) {
                    event.preventDefault();
                    zone.classList.add('drag-over');
                });
                
                zone.addEventListener('dragleave', function(event) {
                    zone.classList.remove('drag-over');
                });
                
                zone.addEventListener('drop', function(event) {
                    event.preventDefault();
                    zone.classList.remove('drag-over');
                    
                    const itemId = event.dataTransfer.getData('text/plain');
                    const draggedItem = document.querySelector(`[data-item="${itemId}"]`);
                    
                    if (draggedItem) {
                        zone.appendChild(draggedItem);
                        logEvent(`Dropped ${draggedItem.textContent} in ${zone.textContent.split(' - ')[0]}`);
                    }
                });
            });
        }

        // Form validation and events
        function setupFormEvents() {
            const form = document.getElementById('demoForm');
            const nameInput = document.getElementById('nameInput');
            const emailInput = document.getElementById('emailInput');
            const ageInput = document.getElementById('ageInput');
            const output = document.getElementById('formOutput');
            let formEvents = [];
            
            function logFormEvent(message) {
                formEvents.push(`${new Date().toLocaleTimeString()}: ${message}`);
                if (formEvents.length > 10) {
                    formEvents.shift();
                }
                output.textContent = formEvents.join('\n');
            }
            
            // Real-time validation
            nameInput.addEventListener('input', function(event) {
                const nameError = document.getElementById('nameError');
                if (event.target.value.length < 2) {
                    nameError.style.display = 'block';
                    logFormEvent('Name validation: Too short');
                } else {
                    nameError.style.display = 'none';
                    logFormEvent('Name validation: Valid');
                }
            });
            
            emailInput.addEventListener('blur', function(event) {
                const emailError = document.getElementById('emailError');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                
                if (!emailRegex.test(event.target.value)) {
                    emailError.style.display = 'block';
                    logFormEvent('Email validation: Invalid format');
                } else {
                    emailError.style.display = 'none';
                    logFormEvent('Email validation: Valid format');
                }
            });
            
            ageInput.addEventListener('change', function(event) {
                const ageError = document.getElementById('ageError');
                const age = parseInt(event.target.value);
                
                if (age < 1 || age > 120) {
                    ageError.style.display = 'block';
                    logFormEvent(`Age validation: ${age} is out of range`);
                } else {
                    ageError.style.display = 'none';
                    logFormEvent(`Age validation: ${age} is valid`);
                }
            });
            
            // Form submission
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                
                const formData = new FormData(form);
                const data = Object.fromEntries(formData);
                
                logFormEvent('Form submitted successfully!');
                logFormEvent(`Data: ${JSON.stringify(data)}`);
                
                // Simulate form processing
                setTimeout(() => {
                    logFormEvent('Form processing complete!');
                }, 1000);
            });
            
            // Form reset
            form.addEventListener('reset', function(event) {
                logFormEvent('Form reset to default values');
                
                // Hide error messages
                document.querySelectorAll('small[id$="Error"]').forEach(error => {
                    error.style.display = 'none';
                });
            });
        }

        // Initialize all demos
        document.addEventListener('DOMContentLoaded', function() {
            setupMouseTracking();
            setupKeyboardEvents();
            setupDragAndDrop();
            setupFormEvents();
            
            console.log('👂 Welcome to JS08: Event Handling!');
            console.log('🎯 Try the interactive demos to learn event handling!');
            
            // Demonstrate event concepts
            console.log('🎪 Event Examples:');
            
            // Custom event example
            document.addEventListener('customDemo', function(event) {
                console.log('Custom event received:', event.detail);
            });
            
            const customEvent = new CustomEvent('customDemo', {
                detail: { message: 'Hello from console demo!' }
            });
            
            document.dispatchEvent(customEvent);
            
            // Mark lesson as started
            localStorage.setItem('js08_started', Date.now());
            localStorage.setItem('js_progress_js08', 'true');
        });
    </script>
</body>
</html>
